---
import type { Locale } from '../../../i18n/locales';
interface Props { locale: Locale; }
const { locale } = Astro.props;
---

<h1>Environment Variables</h1>
<p class="subtitle">All config lives in <code>.env</code>, generated by <code>make bootstrap</code>.</p>

<h2>User-Configurable</h2>
<table>
  <tr><th>Variable</th><th>Default</th><th>Description</th></tr>
  <tr><td><code>DOMAIN</code></td><td><code>localhost</code></td><td>Base domain — all subdomains derived from this</td></tr>
  <tr><td><code>HTTP_PORT</code></td><td><code>80</code></td><td>Port Caddy listens on</td></tr>
  <tr><td><code>MATTERMOST_TEAM_NAME</code></td><td><code>main</code></td><td>Default Mattermost team name</td></tr>
  <tr><td><code>ENABLE_COMMS_COMMANDS</code></td><td><code>true</code></td><td>Create /comms, /mail, /calendar slash commands</td></tr>
  <tr><td><code>ENABLE_COMMS_ONBOARDING</code></td><td><code>true</code></td><td>Send welcome DM with comms links on first login</td></tr>
  <tr><td><code>MAIL_URL</code></td><td><code>{"http://mail.${DOMAIN}"}</code></td><td>Target URL for mail redirect</td></tr>
  <tr><td><code>CALENDAR_URL</code></td><td><code>{"http://calendar.${DOMAIN}"}</code></td><td>Target URL for calendar redirect</td></tr>
  <tr><td><code>CONTACTS_URL</code></td><td><code>{"http://contacts.${DOMAIN}"}</code></td><td>Target URL for contacts redirect</td></tr>
</table>

<h2>Auto-Generated (don't touch)</h2>
<p><code>make bootstrap</code> generates 30+ secrets using <code>openssl rand</code>. These include:</p>
<ul>
  <li>Database passwords for all 7 databases</li>
  <li>OIDC client secrets for all 7 OIDC providers</li>
  <li>Authentik secret key, bootstrap token</li>
  <li>MinIO root password</li>
  <li>OnlyOffice JWT secret</li>
  <li>Stalwart admin password</li>
</ul>

<div class="callout callout-warn">
  <strong>⚠️ Don't re-bootstrap with existing data</strong>
  If you re-run <code>make bootstrap</code>, it regenerates all passwords. Existing database volumes still have the old passwords. Run <code>make destroy</code> first to wipe volumes.
</div>
